<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Perkembangan Harga</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
#iph-app .table-wrap{max-height:55vh;overflow:auto;}
#iph-app th{position:sticky;top:0;background:#e9ecef;z-index:5}
#iph-app .freeze-komoditas{position:sticky;left:0;background:#f8f9fa;z-index:6;min-width:180px}
#iph-app .freeze-pasar{position:sticky;left:180px;background:#f1f3f5;z-index:6;min-width:140px}
#iph-app .naik{color:#dc3545;font-weight:bold}
#iph-app .turun{color:#198754;font-weight:bold}
#iph-app .heat-up{background:#f8d7da;}
#iph-app .heat-down{background:#d1e7dd;}
#iph-app .heat-same{background:#e2e3e5;}
#iph-app .heat-zero{background:#fff;}
/* ===== FIX HEATMAP OVERFLOW ===== */
#iph-app .heatmap-wrap{
  max-height:55vh;
  overflow:auto;
}

#iph-app .heatmap-wrap table{
  width:max-content;
  min-width:100%;
  table-layout:fixed;
}

#iph-app .heatmap-wrap th,
#iph-app .heatmap-wrap td{
  white-space:nowrap;
  text-align:center;
  font-size:12px;
}

</style>
</head>

<body class="bg-light">

<nav class="navbar navbar-dark bg-primary px-3">
  <span class="navbar-brand">
    <i class="bi bi-bar-chart-line"></i> Dashboard Perkembangan Harga
  </span>
</nav>

<div class="container-fluid p-3" id="iph-app">

<div class="card mb-3 shadow-sm">
  <div class="card-body">
    <div class="row g-2 align-items-end">
      <div class="col-md-3">
        <label class="form-label">Komoditas</label>
        <select id="komoditas" class="form-select"></select>
      </div>
      <div class="col-md-3">
        <label class="form-label">Pasar</label>
        <select id="pasar" class="form-select"></select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Bulan</label>
        <select id="bulan" class="form-select">
          <option value="01">Jan</option><option value="02">Feb</option><option value="03">Mar</option>
          <option value="04">Apr</option><option value="05">Mei</option><option value="06">Jun</option>
          <option value="07">Jul</option><option value="08">Agu</option><option value="09">Sep</option>
          <option value="10">Okt</option><option value="11">Nov</option><option value="12">Des</option>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Tahun</label>
        <select id="tahun" class="form-select">
          <option>2024</option><option>2025</option><option>2026</option>
        </select>
      </div>
      <div class="col-md-2 d-grid">
        <button class="btn btn-primary" onclick="loadData()">
          <i class="bi bi-search"></i> Tampilkan
        </button>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-white">
    <i class="bi bi-table"></i> Harga Harian
  </div>
  <div class="card-body p-0">
    <div class="table-wrap">
      <table class="table table-bordered table-sm mb-0" id="tabelHarian"></table>
    </div>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-white">
    <i class="bi bi-calendar-week"></i> IPH Mingguan
  </div>
  <div class="card-body p-0">
    <table class="table table-bordered mb-0" id="tabelMingguan"></table>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-white">
    <i class="bi bi-percent"></i> Perubahan Harga (%)
  </div>
  <div class="card-body p-0">
    <table class="table table-bordered mb-0" id="tabelPersen"></table>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-white">
    <i class="bi bi-graph-up"></i> Grafik IPH
  </div>
  <div class="card-body">
    <canvas id="chartIPH" height="100"></canvas>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-white">
    <i class="bi bi-grid-3x3-gap"></i> Heatmap Harga Harian
  </div>
  <div class="card-body p-0">
    <div class="table-wrap heatmap-wrap">
      <div id="heatmap"></div>
    </div>
  </div>
</div>

</div>

<script src="app.js">
/* ===== TEMPEL FULL JS FINAL DARI PESAN SEBELUMNYA DI SINI ===== */
</script>

</body>
</html>

